<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.361">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Day 9 lab LMs and GLMs Solutions</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="day09-lab-lm-glm-solutions_files/libs/clipboard/clipboard.min.js"></script>
<script src="day09-lab-lm-glm-solutions_files/libs/quarto-html/quarto.js"></script>
<script src="day09-lab-lm-glm-solutions_files/libs/quarto-html/popper.min.js"></script>
<script src="day09-lab-lm-glm-solutions_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="day09-lab-lm-glm-solutions_files/libs/quarto-html/anchor.min.js"></script>
<link href="day09-lab-lm-glm-solutions_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="day09-lab-lm-glm-solutions_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="day09-lab-lm-glm-solutions_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="day09-lab-lm-glm-solutions_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="day09-lab-lm-glm-solutions_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#organizing-our-knowledge" id="toc-organizing-our-knowledge" class="nav-link active" data-scroll-target="#organizing-our-knowledge">Organizing our knowledge</a>
  <ul class="collapse">
  <li><a href="#section" id="toc-section" class="nav-link" data-scroll-target="#section">1</a></li>
  <li><a href="#section-1" id="toc-section-1" class="nav-link" data-scroll-target="#section-1">2</a></li>
  </ul></li>
  <li><a href="#logistic-regression" id="toc-logistic-regression" class="nav-link" data-scroll-target="#logistic-regression">Logistic regression</a>
  <ul class="collapse">
  <li><a href="#section-2" id="toc-section-2" class="nav-link" data-scroll-target="#section-2">1</a></li>
  <li><a href="#a" id="toc-a" class="nav-link" data-scroll-target="#a">2a</a></li>
  <li><a href="#b" id="toc-b" class="nav-link" data-scroll-target="#b">2b</a></li>
  <li><a href="#c" id="toc-c" class="nav-link" data-scroll-target="#c">2c</a></li>
  <li><a href="#d" id="toc-d" class="nav-link" data-scroll-target="#d">2d</a></li>
  <li><a href="#a-1" id="toc-a-1" class="nav-link" data-scroll-target="#a-1">3a</a></li>
  <li><a href="#b-1" id="toc-b-1" class="nav-link" data-scroll-target="#b-1">3b</a></li>
  </ul></li>
  <li><a href="#poisson-regression" id="toc-poisson-regression" class="nav-link" data-scroll-target="#poisson-regression">Poisson regression</a>
  <ul class="collapse">
  <li><a href="#a-2" id="toc-a-2" class="nav-link" data-scroll-target="#a-2">1a</a></li>
  <li><a href="#b-2" id="toc-b-2" class="nav-link" data-scroll-target="#b-2">1b</a></li>
  <li><a href="#c-1" id="toc-c-1" class="nav-link" data-scroll-target="#c-1">1c</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Day 9 lab LMs and GLMs Solutions</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="organizing-our-knowledge" class="level2">
<h2 class="anchored" data-anchor-id="organizing-our-knowledge">Organizing our knowledge</h2>
<section id="section" class="level3">
<h3 class="anchored" data-anchor-id="section">1</h3>
<p>Fill in the table below to organize what we have learned about linear and generalized linear models.</p>
<table class="table">
<colgroup>
<col style="width: 14%">
<col style="width: 15%">
<col style="width: 21%">
<col style="width: 48%">
</colgroup>
<thead>
<tr class="header">
<th>Data scenario</th>
<th><p>Model name</p>
<p>(and model class)</p></th>
<th>Model equation (with 1 predictor)</th>
<th>Interpretation of predictor coefficient</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Continuous response variable</td>
<td><p>Linear model</p>
<p>(LM)</p></td>
<td><span class="math inline">\(E[Y_i] = \beta_0 + \beta_1 X_i\)</span></td>
<td><span class="math inline">\(\beta_1\)</span> is the expected change in <span class="math inline">\(Y\)</span> for a one unit increase in <span class="math inline">\(X\)</span>.</td>
</tr>
<tr class="even">
<td>Binary response variable</td>
<td>Logistic regression (GLM)</td>
<td><span class="math inline">\(log(\frac{\pi_i}{1 - \pi_i}) = \beta_0 + \beta_1 X_i\)</span></td>
<td><p><span class="math inline">\(\beta_1\)</span> is the change in log odds for a one unit increase in <span class="math inline">\(X\)</span>.</p>
<p><span class="math inline">\(e^{\beta_1}\)</span> is the odds ratio for a one unit increase in <span class="math inline">\(X\)</span>.</p>
<p><span class="math inline">\(e^{\beta_1} -1\)</span> is the percent increase/decrease in odds for a one unit increase in <span class="math inline">\(X\)</span>.</p></td>
</tr>
<tr class="odd">
<td>Count data as response variable</td>
<td>Poisson regression (GLM)</td>
<td><span class="math inline">\(\log(\lambda_i) = \beta_0 + \beta_1 X\)</span></td>
<td><p><span class="math inline">\(\beta_1\)</span> is the log rate ratio (or relative risk or multiplicative change in risk) for a one unit increase in <span class="math inline">\(X\)</span>.</p>
<p><span class="math inline">\(e^{\beta_1}\)</span> is the rate ratio for a one unit increase in <span class="math inline">\(X\)</span>.</p></td>
</tr>
<tr class="even">
<td>Categorical (3+) response variable</td>
<td>Multinomial logistic regression (GLM)</td>
<td>Let’s not worry about it…</td>
<td>Each category level of the model is interpreted as if it is a logistic regression, with respect to the same reference group.</td>
</tr>
</tbody>
</table>
<p>Comments about Multionomial logistic regression:</p>
<ul>
<li><p>“Multinomial logistic regression for a response with J + 1 categories is analogous to simultaneously fitting J logistic regressions with the same reference group</p></li>
<li><p>Although the choice of reference is arbitrary (models with different reference groups are simply reparameterizations of one another), it is usually easiest to choose the most common outcome as the reference group</p></li>
<li><p>In general, simultaneous estimation will lead to a more efficient model than the separate logistic regressions” - Bin Nan</p></li>
</ul>
</section>
<section id="section-1" class="level3">
<h3 class="anchored" data-anchor-id="section-1">2</h3>
<p>What test can we use to compare two nested models (i.e.&nbsp;One model has a subset of the covariates of the other model)?</p>
<p><strong>Solution</strong></p>
<p>We can do this with the likelihood ratio test.</p>
</section>
</section>
<section id="logistic-regression" class="level2">
<h2 class="anchored" data-anchor-id="logistic-regression">Logistic regression</h2>
<p>If we made an alzheimer diagnosis variable <code>alzh</code> then we have a binary response variable.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.2     ✔ readr     2.1.4
✔ forcats   1.0.0     ✔ stringr   1.5.0
✔ ggplot2   3.4.2     ✔ tibble    3.2.1
✔ lubridate 1.9.2     ✔ tidyr     1.3.0
✔ purrr     1.0.1     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>alzheimer_og <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"alzheimer_data.csv"</span>, <span class="at">show_col_types =</span> <span class="cn">FALSE</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co">#glimpse(alzheimer)</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>alzheimer <span class="ot">&lt;-</span> alzheimer_og <span class="sc">%&gt;%</span> </span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">alzh =</span> <span class="fu">ifelse</span>(diagnosis <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="at">yes =</span> <span class="dv">1</span>, <span class="at">no =</span> <span class="dv">0</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can fit a linear model and we won’t get an error (even though linear model assumption are violated), but does it provide any useful information?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>alzheimer_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(alzh <span class="sc">~</span> age <span class="sc">+</span> female <span class="sc">+</span>  educ <span class="sc">+</span> lhippo <span class="sc">+</span> rhippo, <span class="at">data =</span> alzheimer)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>alzheimer <span class="sc">%&gt;%</span> </span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">alzh_lm_prediction =</span> <span class="fu">predict</span>(alzheimer_lm)) <span class="sc">%&gt;%</span> </span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> alzh, <span class="at">y =</span> alzh_lm_prediction)) <span class="sc">+</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="day09-lab-lm-glm-solutions_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><strong>Solution</strong></p>
<p>An assumption of the linear model is that the errors, and therefore the response variable is normally distributed, so the possible values range from <span class="math inline">\((-\infty, \infty)\)</span>. Here the expected value of our response variable is the probability of having Alzheimers, which is bounded between 0 and 1, so the linear model will predict impossible values.</p>
<section id="section-2" class="level3">
<h3 class="anchored" data-anchor-id="section-2">1</h3>
<p>Instead let’s fit a logistic model since we have a binary response variable. Fit the logistic model with <code>alzh</code> as the response variable and the same covariates as the linear model fit above. Save the model fit into a variable named <code>alzheimer_glm</code>.</p>
<p><strong>Solution</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>alzheimer_glm <span class="ot">&lt;-</span> <span class="fu">glm</span>(alzh <span class="sc">~</span> age <span class="sc">+</span> female <span class="sc">+</span> educ <span class="sc">+</span> lhippo, <span class="at">family =</span> binomial, <span class="at">data =</span> alzheimer)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Run this code to produce a plot of the predicted values after you have fit the model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>alzheimer <span class="sc">%&gt;%</span> </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">alzh_glm_prediction =</span> <span class="fu">predict</span>(alzheimer_glm, <span class="at">type =</span> <span class="st">"response"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> alzh, <span class="at">y =</span> alzh_glm_prediction)) <span class="sc">+</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="day09-lab-lm-glm-solutions_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="a" class="level3">
<h3 class="anchored" data-anchor-id="a">2a</h3>
<p>Provide an interpretation in context for the coefficient of <code>age</code> in the logistic model. Also, compute the 95% confidence interval for this coefficient.</p>
<p><strong>Solution</strong></p>
<p>You can look at the model summary for the necessary information</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>alzheimer_glm_summary <span class="ot">&lt;-</span> <span class="fu">summary</span>(alzheimer_glm)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="co"># alzheimer_glm_summary</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>age_coeff_est <span class="ot">&lt;-</span> alzheimer_glm_summary<span class="sc">$</span>coefficients[<span class="st">"age"</span>, <span class="st">"Estimate"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>For people with common sex, education, and left hippocampus volume, we estimate a one year increase in age to be associated with a **log odds ratio* of having Alzheimers of 0.0181.</p>
<p>Now, let’s compute the confidence interval. I suggest doing this manually (i.e.&nbsp;not using a function, so you are clear on how it is calculated).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>age_coeff_std_error <span class="ot">&lt;-</span> alzheimer_glm_summary<span class="sc">$</span>coefficients[<span class="st">"age"</span>, <span class="st">"Std. Error"</span>]</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>age_coeff_ci <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  age_coeff_est <span class="sc">-</span> <span class="fl">1.96</span><span class="sc">*</span>age_coeff_std_error, </span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  age_coeff_est <span class="sc">+</span> <span class="fl">1.96</span><span class="sc">*</span>age_coeff_std_error</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We estimate the <strong>log odds ratio</strong> of having Alzheimers associated with an increase of one year of age to be between 0.0098 and 0.0265 with 95% confidence, when controlling for sex, education, and left hippocampus volume.</p>
</section>
<section id="b" class="level3">
<h3 class="anchored" data-anchor-id="b">2b</h3>
<p>Provide an interpretation in context for the <strong>exponentiated</strong> coefficient of <code>age</code> in the logistic model. Also, compute the 95% confidence interval for this coefficient.</p>
<p><strong>Solution</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>exp_age_coeff_est <span class="ot">&lt;-</span> <span class="fu">exp</span>(age_coeff_est)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>exp_age_coeff_ci <span class="ot">&lt;-</span> <span class="fu">exp</span>(age_coeff_ci)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>For people with common sex, education, and left hippocampus volume, we estimate a one year increase in age to be associated with a an <strong>odds ratio</strong> of having Alzheimers of 1.0183. We estimate this value to be between 1.0099 and 1.0268 with 95% confidence.</p>
</section>
<section id="c" class="level3">
<h3 class="anchored" data-anchor-id="c">2c</h3>
<p>Calculate the estimate and 95% confidence interval for the percent change in odds associated with a 1 year difference in age, controlling for the other predictors.</p>
<p><strong>Solution</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>per_inc_age_coeff_est <span class="ot">&lt;-</span> (<span class="fu">exp</span>(age_coeff_est) <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>per_inc_age_coeff_ci <span class="ot">&lt;-</span> (<span class="fu">exp</span>(age_coeff_ci) <span class="sc">-</span><span class="dv">1</span> ) <span class="sc">*</span> <span class="dv">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>For people with common sex, education, and left hippocampus volume, we estimate a one year increase in age to be associated with a 1.8303% <strong>increase in the odds</strong> of having Alzheimers. We estimate this value to be between 0.9864% and 2.6813% with 95% confidence.</p>
</section>
<section id="d" class="level3">
<h3 class="anchored" data-anchor-id="d">2d</h3>
<p>Which transformation of the estimate of the coefficient of <code>age</code> is most interpretable to you?</p>
<p><strong>Solution</strong></p>
<p>The interpretation from 2c would be most interpretable to someone who does not know statistics and therefore does not know what an odds ratio is.</p>
</section>
<section id="a-1" class="level3">
<h3 class="anchored" data-anchor-id="a-1">3a</h3>
<p>Provide an interpretation in context for the coefficient of <code>female</code> in the logistic model. Also, compute the 95% confidence interval for this coefficient.</p>
<p><strong>Solution</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>female_coeff_est <span class="ot">&lt;-</span> alzheimer_glm_summary<span class="sc">$</span>coefficients[<span class="st">"female"</span>, <span class="st">"Estimate"</span>]</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>female_coeff_std_error <span class="ot">&lt;-</span> alzheimer_glm_summary<span class="sc">$</span>coefficients[<span class="st">"female"</span>, <span class="st">"Std. Error"</span>]</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>female_coeff_ci <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  female_coeff_est <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> female_coeff_std_error,</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  female_coeff_est <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> female_coeff_std_error</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>For people with common age, education, and left hippocampus volume, we estimate that females, compared to males, are associated with a <strong>log odds ratio</strong> of having Alzheimers of -1.3202. We estimate this quantity to be between -1.5094 and -1.131 with 95% confidence.</p>
</section>
<section id="b-1" class="level3">
<h3 class="anchored" data-anchor-id="b-1">3b</h3>
<p>Provide an interpretation in context for the exponentiated coefficient of <code>female</code> in the logistic model. Also, compute the 95% confidence interval for this coefficient.</p>
<p><strong>Solution</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>exp_female_coeff_est <span class="ot">&lt;-</span> <span class="fu">exp</span>(female_coeff_est)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>exp_female_coeff_ci <span class="ot">&lt;-</span> <span class="fu">exp</span>(female_coeff_ci)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>For people with common age, education, and left hippocampus volume, we estimate that females, compared to males, are associated with an ** odds ratio** of having Alzheimers of 0.2671. We estimate this quantity to be between 0.221 and 0.3227 with 95% confidence.</p>
<p>Even more interpretable:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>per_dec_female_coeff_est <span class="ot">&lt;-</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(female_coeff_est)) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>per_dec_female_coeff_ci <span class="ot">&lt;-</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(female_coeff_ci)) <span class="sc">*</span> <span class="dv">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>For people with common age, education, and left hippocampus volume, we estimate that females have a 73.2919% decrease in odds of having Alzheimers, relative to males. We estimate this quantity to be between 77.896 and 67.7289 with 95% confidence.</p>
</section>
</section>
<section id="poisson-regression" class="level2">
<h2 class="anchored" data-anchor-id="poisson-regression">Poisson regression</h2>
<p>Read in the neuron data from lecture.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>chosen_neuron_data_og <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">"https://www.ics.uci.edu/~zhaoxia/Data/chosen_neuron_data.csv"</span>,</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">show_col_types =</span> <span class="cn">FALSE</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>chosen_neuron_data <span class="ot">&lt;-</span> chosen_neuron_data_og <span class="sc">%&gt;%</span> </span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(trial_number, n_spikes, image_categ)</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="co">#glimpse(chosen_neuron_data)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="a-2" class="level3">
<h3 class="anchored" data-anchor-id="a-2">1a</h3>
<p>Fit generalized linear model regressing number of spikes on image category without an intercept (add “-1” to regression equation to remove intercept). Save your regression into a variable named <code>poisson_fit</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit generalized linear model</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Poisson GLM with the default log link function</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>poisson_fit <span class="ot">&lt;-</span> <span class="fu">glm</span>(</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  n_spikes <span class="sc">~</span> image_categ <span class="sc">-</span> <span class="dv">1</span>,</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> chosen_neuron_data,</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link=</span><span class="st">"log"</span>)</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Tabulate the coefficient estimates using the code below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>poisson_neuron_table <span class="ot">&lt;-</span> <span class="fu">summary</span>(poisson_fit)<span class="sc">$</span>coefficients</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="fu">row.names</span>(poisson_neuron_table) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Animal"</span>, <span class="st">"Fruit"</span>,</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="st">"Kids"</span>, <span class="st">"Military"</span>, <span class="st">"Space"</span>)</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>poisson_neuron_table</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          Estimate Std. Error   z value     Pr(&gt;|z|)
Animal   -2.995732  0.9999998 -2.995733 2.737861e-03
Fruit     1.280934  0.1178511 10.869084 1.618171e-27
Kids     -1.897120  0.5773503 -3.285908 1.016541e-03
Military -1.386294  0.4472132 -3.099851 1.936181e-03
Space    -2.995732  0.9999998 -2.995733 2.737861e-03</code></pre>
</div>
</div>
</section>
<section id="b-2" class="level3">
<h3 class="anchored" data-anchor-id="b-2">1b</h3>
<p>Provide an interpretation of the coefficient for <code>animal</code>.</p>
<p><strong>Solution</strong></p>
<p>Interpretation here is actually easier than in the other example since we do not have an intercept and only have a categorical predictor.</p>
<p>Full model:</p>
<p><span class="math display">\[\log(E[ \text{Number of Neurons}_i | \text{Image} = x_i]) = \beta_0 * I(x_i = \text{Animal}) + \beta_1 * I(x_i = \text{Fruit}) + \beta_2 * I(x_i = \text{Kids}) + \beta_3 * I(x_i = \text{Military}) + \beta_4 * I(x_i = \text{Space})\]</span></p>
<p>Specific case where the image is animal:</p>
<p><span class="math display">\[\log(E[ \text{Number of Neurons}_i | \text{Image} = \text{Animal}]) = \beta_0 * 1 + \beta_1 * 0 + \beta_2 * 0 + \beta_3 * 0 + \beta_3 * 0 = \beta_0\]</span></p>
<p><em>Recall:</em> An indicator function has value 1 if the condition is true, and has value 0 if the condition is false.</p>
<p>This means <span class="math inline">\(\beta_1\)</span> is log neuron rate associated with being shown an image of an animal.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>animal_coeff_est <span class="ot">&lt;-</span> poisson_neuron_table[<span class="st">"Animal"</span>, <span class="st">"Estimate"</span>] </span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>animal_coeff_std_error <span class="ot">&lt;-</span> poisson_neuron_table[<span class="st">"Animal"</span>, <span class="st">"Std. Error"</span>]</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>animal_coeff_ci <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>  animal_coeff_est <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> animal_coeff_std_error,</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>  animal_coeff_est <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> animal_coeff_std_error</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s use the exponentiated version of the coefficient for better interpretability.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>exp_animal_coeff_est <span class="ot">&lt;-</span> <span class="fu">exp</span>(animal_coeff_est)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>exp_animal_coeff_ci <span class="ot">&lt;-</span> <span class="fu">exp</span>(animal_coeff_ci)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We estimate the neuron rate to be between <code>r</code>round(exp_animal_coeff_est, 3)<code>for people shown an image of an animal. We are 95% confidence the rate is between</code>r <code>round(exp_animal_coeff_ci[1], 3)</code> and <code>r</code>round(exp_animal_coeff_ci<a href="#section-1">2</a>, 3)`.</p>
</section>
<section id="c-1" class="level3">
<h3 class="anchored" data-anchor-id="c-1">1c</h3>
<p>What would be the interpretation of the coefficient for <code>animal</code> if there was an intercept?</p>
<p><strong>Solution</strong></p>
<p>If we had an intercept, then one level of our categorical predictor would have to be the reference group to avoid multicolinearity.</p>
<p>Here we have two different possible scenarios, where animal is the reference group and when it is not.</p>
<section id="animal-as-reference-group" class="level4">
<h4 class="anchored" data-anchor-id="animal-as-reference-group">Animal as reference group</h4>
<p>Full model:</p>
<p><span class="math display">\[\log(E[ \text{Number of Neurons}_i | \text{Image} = x_i]) = \beta_0 + \beta_1 * I(x_i = \text{Fruit}) + \beta_2 * I(x_i = \text{Kids}) + \beta_3 * I(x_i = \text{Military}) + \beta_4 * I(x_i = \text{Space})\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit generalized linear model</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Poisson GLM with the default log link function</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>poisson_fit <span class="ot">&lt;-</span> <span class="fu">glm</span>(</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  n_spikes <span class="sc">~</span> image_categ,</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> chosen_neuron_data,</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link=</span><span class="st">"log"</span>)</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(poisson_fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = n_spikes ~ image_categ, family = poisson(link = "log"), 
    data = chosen_neuron_data)

Coefficients:
                      Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)         -2.996e+00  1.000e+00  -2.996  0.00274 ** 
image_categFruit     4.277e+00  1.007e+00   4.247 2.16e-05 ***
image_categKids      1.099e+00  1.155e+00   0.951  0.34139    
image_categMilitary  1.609e+00  1.095e+00   1.469  0.14178    
image_categSpace     2.120e-15  1.414e+00   0.000  1.00000    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 260.985  on 99  degrees of freedom
Residual deviance:  81.213  on 95  degrees of freedom
AIC: 163.18

Number of Fisher Scoring iterations: 6</code></pre>
</div>
</div>
<p>Animal was made the reference group by default since it is the first category present.</p>
<p>Specific case where the image is animal:</p>
<p><span class="math display">\[\log(E[ \text{Number of Neurons}_i | \text{Image} = x_i]) = \beta_0 + \beta_1 * 0 + \beta_2 * 0 + \beta_3 * 0 + \beta_4 * 0 = \beta_0\]</span></p>
<p>Notice the intercept in this model is equivalent to the first coefficient in the previous mode.</p>
</section>
<section id="animal-not-reference-group" class="level4">
<h4 class="anchored" data-anchor-id="animal-not-reference-group">Animal not reference group</h4>
<p>There is no obvious image to make the reference group in this case so I will arbitrarily pick Fruit to be the reference group.</p>
<p>Full model:</p>
<p><span class="math display">\[\log(E[ \text{Number of Neurons}_i | \text{Image} = x_i]) = \beta_0 + \beta_1 * I(x_i = \text{Fruit}) + \beta_2 * I(x_i = \text{Kids}) + \beta_3 * I(x_i = \text{Military}) + \beta_4 * I(x_i = \text{Space})\]</span></p>
<p>In this model, since we have a reference group, <span class="math inline">\(\beta_1\)</span> is the log rate ratio for people shown an animal image compared to those shown a fruit image.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Start by manually specifying the category order </span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="co"># The first is the reference group</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>chosen_neuron_data_releveled <span class="ot">&lt;-</span> chosen_neuron_data <span class="sc">%&gt;%</span> </span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">image_categ =</span> <span class="fu">factor</span>(</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>    image_categ,</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Fruit"</span>, <span class="st">"Animal"</span>, <span class="st">"Kids"</span>, <span class="st">"Military"</span>, <span class="st">"Space"</span>)</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>poisson_fit <span class="ot">&lt;-</span> <span class="fu">glm</span>(</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>  n_spikes <span class="sc">~</span> image_categ,</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> chosen_neuron_data_releveled,</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link=</span><span class="st">"log"</span>)</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>(poisson_fit_summary <span class="ot">&lt;-</span> <span class="fu">summary</span>(poisson_fit))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = n_spikes ~ image_categ, family = poisson(link = "log"), 
    data = chosen_neuron_data_releveled)

Coefficients:
                    Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)           1.2809     0.1179  10.869  &lt; 2e-16 ***
image_categAnimal    -4.2767     1.0069  -4.247 2.16e-05 ***
image_categKids      -3.1781     0.5893  -5.393 6.92e-08 ***
image_categMilitary  -2.6672     0.4625  -5.767 8.06e-09 ***
image_categSpace     -4.2767     1.0069  -4.247 2.16e-05 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 260.985  on 99  degrees of freedom
Residual deviance:  81.213  on 95  degrees of freedom
AIC: 163.18

Number of Fisher Scoring iterations: 6</code></pre>
</div>
</div>
<p>Specific case where the image is animal:</p>
<p><span class="math display">\[\log(E[ \text{Number of Neurons}_i | \text{Image} = x_i]) = \beta_0 + \beta_1 * 1 + \beta_2 * 0 + \beta_3 * 0 + \beta_4 * 0 = \beta_0 + \beta_1\]</span></p>
<p>To get the estimate for the rate for people shown an animal (not relative to a reference group) we would add the coefficients <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>(beta0 <span class="ot">&lt;-</span> poisson_fit_summary<span class="sc">$</span>coefficients[<span class="st">"(Intercept)"</span>, <span class="st">"Estimate"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.280934</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>(animal_coeff <span class="ot">&lt;-</span> poisson_fit_summary<span class="sc">$</span>coefficients[<span class="st">"image_categAnimal"</span>, <span class="st">"Estimate"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -4.276666</code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>neuron_rate_animal_image <span class="ot">&lt;-</span> beta0 <span class="sc">+</span> animal_coeff</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>